#!/bin/bash

# this command should not be used on virtual interfaces

if [[ -z $@ || $@ == "-h" || $@ == "--help" ]]; then
	echo -e "Resets and spoofs interface.\nThis command should not be used on virtual interfaces!\n  Usage: ifreset <interface>"
else
	echo "Resetting & spoofing $@ ..."

	phy="phy$(echo $@ | sed -e s/^[a-z]*//)"

	# reset
	iw dev $@ del &> /dev/null
	iw dev $@mon del &> /dev/null
	iw phy $phy interface add $@ type managed
	rfkill unblock wifi

	# spoof
	ifconfig $@ down
	macchanger -rb $@ &> /dev/null
	ifconfig $@ up

	# check
	macchanger $@
fi
